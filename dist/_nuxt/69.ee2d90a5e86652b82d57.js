webpackJsonp([69],{"/l0L":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("base-header",{attrs:{title:"专享优惠券"}}),t._m(0),o("div",{staticClass:"bg-white plr30 pb10"},t._l(t.coupons,function(e,n){return o("vip-coupon-item",{key:n,staticClass:"mb20",attrs:{coupon:e,getCoupon:t.getCoupon}})}),1),o("load-more",{attrs:{handler:t.fetchCoupons}})],1)},r=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"bg-white pd30"},[e("img",{staticClass:"w100",attrs:{src:o("ectJ")}})])}];n._withStripped=!0;var s={render:n,staticRenderFns:r};e.a=s},Vov0:function(t,e,o){var n=o("dFxI");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);o("rjj0")("80d37436",n,!1,{sourceMap:!1})},cqYD:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"relative flex-wrp coupon"},[o("div",{staticClass:"flex-item plr15 vip-badge flex-wrp pt40"},[o("div",{staticClass:"flex-wrp flex-cell flex-end color3 size22"},[o("div",{staticClass:"text-right color2 lh100"},[[1,3,4].findIndex(function(e){return e==t.coupon.type})>-1?o("span",{staticClass:"size26"},[t._v("￥")]):t._e(),o("span",{staticClass:"size60 color37 lighter"},[t._v(t._s(t._f("number_format")(t.coupon.value)))]),2==t.coupon.type?o("span",{staticClass:"size26"},[t._v("折")]):t._e()]),o("div",{staticClass:"color36 bold nowrap"},[1==t.coupon.type?[t._v("\n                    满减优惠券\n                ")]:2==t.coupon.type?[t._v("\n                    折扣优惠券\n                ")]:3==t.coupon.type?[t._v("\n                    支付代金券\n                ")]:4==t.coupon.type?[t._v("\n                    新人专享券\n                ")]:t._e()],2)]),o("div",{staticClass:"color27 pl20 text-nowrap width-auto"},[o("span",{staticClass:"size28 color37 lighter"},[t._v(t._s(t.coupon.title))]),o("div",{staticClass:"color4 size22"},[1==t.coupon.type?[t._v("\n                    满"+t._s(t.coupon.condition)+"元可用\n                ")]:1==t.coupon.type&&0!=t.coupon.condition?[t._v("\n                    最高抵"+t._s(t.coupon.condition)+"元\n                ")]:t._e()],2)])]),t.coupon.is_receive?o("nuxt-link",{staticClass:"size26 color36 plr20 ptb30 coupon-btn",attrs:{to:"/shop_"+t.coupon.shop.id}},[t._v("立即使用")]):o("div",{staticClass:"size26 color36 plr20 ptb30 coupon-btn",on:{click:function(e){return t.getCoupon(t.coupon)}}},[t._v("立即领取")])],1)};n._withStripped=!0;var r={render:n,staticRenderFns:[]};e.a=r},dFxI:function(t,e,o){(t.exports=o("FZ+f")(!1)).push([t.i,'.coupon[data-v-23ff0242]{-webkit-box-shadow:0 0 .21875rem rgba(0,0,0,.2);box-shadow:0 0 .21875rem rgba(0,0,0,.2)}.coupon-btn[data-v-23ff0242]{position:relative;width:1.9375rem;white-space:normal;line-height:100%;border-left:.03125rem dashed #d9d9d9}.coupon-btn[data-v-23ff0242]:after,.coupon-btn[data-v-23ff0242]:before{display:block;content:"";width:.3125rem;height:.3125rem;position:absolute;left:-.15625rem;background:#fff;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);border:.03125rem solid rgba(0,0,0,.1);border-width:0 0 .03125rem .03125rem}.coupon-btn[data-v-23ff0242]:before{top:-.15625rem}.coupon-btn[data-v-23ff0242]:after{bottom:-.15625rem;border-width:.03125rem .03125rem 0 0}',""])},ectJ:function(t,e,o){t.exports=o.p+"img/vip_banner_coupon.8efaeb8.png"},gJnm:function(t,e,o){"use strict";var n=o("qkC6"),r=o("cqYD"),s=!1;var i=function(t){s||o("Vov0")},a=o("VU/8")(n.a,r.a,!1,i,"data-v-23ff0242",null);a.options.__file="components/Vip/Coupon/Item.vue",e.a=a.exports},nDAj:function(t,e,o){"use strict";var n=o("Xxa5"),r=o.n(n),s=o("woOf"),i=o.n(s),a=o("exGp"),c=o.n(a),u=o("Dd8w"),p=o.n(u),l=o("gJnm"),f=o("RWSh"),d=o("NYxO");e.a={data:function(){return{coupons:[],filter:{limit:10,offset:0,is_vip:1}}},components:{VipCouponItem:l.a},computed:p()({},Object(d.mapState)({user:function(t){return t.user.info}})),methods:{getCoupon:function(){var t=c()(r.a.mark(function t(e){var o,n,s,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=this,this.user.is_vip){t.next=3;break}return t.abrupt("return",weui.confirm("您未开通嘟嘟特权",{title:"暂无法领取",buttons:[{label:"放弃领取",type:"default"},{label:"立即开通",type:"primary",onClick:function(){o.$router.push("/order_vip")}}]}));case 3:return n=weui.loading("加载中..."),t.next=6,f.a.post("/new_coupon/"+e.id+"/receive",{from:4});case 6:s=t.sent,a=s.data,n.hide(),"SUCCESS"===a.code?(this.coupons=this.coupons.map(function(t){return t.id===a.res.coupon_id?i()({},t,{is_receive:!0,user_receive_num:parseInt(t.user_receive_num)+1}):t}),weui.alert("领取成功")):a.msg&&weui.alert(a.msg);case 10:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),fetchCoupons:function(){var t=c()(r.a.mark(function t(){var e,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.a.get("/new_coupon",i()({},this.filter,{offset:this.coupons.length}));case 2:return e=t.sent,o=e.data,this.coupons=this.coupons.concat(o.coupons||[]),t.abrupt("return",{length:this.coupons.length,isMore:(o.coupons||[]).length>=this.filter.limit});case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}}},qkC6:function(t,e,o){"use strict";e.a={props:{getCoupon:{required:!0},coupon:{type:Object,required:!0}}}},w3a0:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("nDAj"),r=o("/l0L"),s=o("VU/8")(n.a,r.a,!1,null,null,null);s.options.__file="pages/vip/coupon.vue",e.default=s.exports}});