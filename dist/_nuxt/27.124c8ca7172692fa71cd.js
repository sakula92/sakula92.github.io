webpackJsonp([27],{"3T1h":function(e,t,i){var n=i("AJBa");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i("rjj0")("638a8219",n,!1,{sourceMap:!1})},AJBa:function(e,t,i){(e.exports=i("FZ+f")(!1)).push([e.i,".colore[data-v-5a417cc0]{color:#eee}",""])},BdUl:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("Tg06"),r=i("jYZW"),s=!1;var a=function(e){s||i("FM7Z")},o=i("VU/8")(n.a,r.a,!1,a,"data-v-18286121",null);o.options.__file="pages/comment/_id.vue",t.default=o.exports},DKNh:function(e,t,i){"use strict";var n=function(){var e=this.$createElement,t=this._self._c||e;return this.isPreview?t("div",[t("div",{directives:[{name:"swiper",rawName:"v-swiper:shopPhosSwiper",value:{initialSlide:this.initial},expression:"{initialSlide :this.initial}",arg:"shopPhosSwiper"}],staticClass:"preview-img-mask",on:{click:this.close}},[t("div",{staticClass:"swiper-wrapper"},this._l(this.images,function(e,i){return t("div",{key:i,staticClass:"swiper-slide overflow-hidden block"},[t("img",{staticClass:"block w100",attrs:{src:e}})])}),0)]),t("div",{staticClass:"preview-img-bg",on:{click:this.close}})]):this._e()};n._withStripped=!0;var r={render:n,staticRenderFns:[]};t.a=r},Ds5F:function(e,t,i){"use strict";var n=i("Dd8w"),r=i.n(n),s=i("Xxa5"),a=i.n(s),o=i("exGp"),c=i.n(o),l=i("DHvs"),m=i("NYxO");t.a={asyncData:function(){var e=c()(a.a.mark(function e(t){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i={btnText:"登录",backUrl:t.query.url,loginParam:{},loginResponseData:{}},e.abrupt("return",i);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),computed:r()({},Object(m.mapState)({session:function(e){return e.session}})),mounted:function(){var e=this;window.loginForResponse=function(t,i,n,r){e.loginResponseData={type:"app",url:t,data:i,sign:n,avatar:r},e.getUserInfoForZyBank()},window.wechatLoginForResponse=function(t,i){e.loginResponseData={type:"wechat",data:t,sign:i},e.getUserInfoForZyBank()},window.onResponseError=function(){weui.toast("未正常登录,请重试")}},methods:{setUserCity:function(){var e=c()(a.a.mark(function e(t,i,n){var r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this,e.next=3,l.b.get("/zybank/loginLogs",{city_id:t,type:i,status:n});case 3:r=e.sent,r.data;case 5:case"end":return e.stop()}},e,this)}));return function(t,i,n){return e.apply(this,arguments)}}(),getUserInfoForZyBank:function(){var e=c()(a.a.mark(function e(){var t,i,n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.b.post("/zybank/setlogin",this.loginResponseData);case 2:if(t=e.sent,i=t.data,200!==t.status||"SUCCESS"!==i.code){e.next=13;break}return e.next=8,this.$store.dispatch("user/getUser");case 8:this.userinfo=this.$store.state.user.info,n=window.localStorage.getItem("current_city")?JSON.parse(window.localStorage.getItem("current_city")):{},this.setUserCity(n.city_id||"","0",n.status||"2"),e.next=14;break;case 13:weui.toast("登录失败");case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),Login:function(){var e=c()(a.a.mark(function e(t){var i,n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=location.href,e.next=3,l.b.get("/zybank/prelogin",{url:i});case 3:n=e.sent,r=n.data,200===n.status&&"SUCCESS"===r.code&&(this.loginParam=r.data),e.t0=t,e.next="app"===e.t0?10:"wechat"===e.t0?12:14;break;case 10:return Object(l.d)()?window.demo.clickOnAndroid(this.loginParam.loginUrl,this.loginParam.crypted,this.loginParam.sign):Object(l.e)()&&(window.location.href="objc://loginBank:/,"+this.loginParam.loginUrl+","+this.loginParam.crypted+","+this.loginParam.sign),e.abrupt("break",14);case 12:return Object(l.d)()?window.demo.wechatLoginOnAndroid():Object(l.e)()&&(window.location.href="objc://wechatLogin:/"),e.abrupt("break",14);case 14:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}}},FM7Z:function(e,t,i){var n=i("S7RC");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i("rjj0")("24019583",n,!1,{sourceMap:!1})},L8Vq:function(e,t,i){var n=i("QjDt");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i("rjj0")("70abde03",n,!1,{sourceMap:!1})},Ldk8:function(e,t,i){(e.exports=i("FZ+f")(!1)).push([e.i,".login-bounce[data-v-01f91858]{width:17.5rem;height:14.6875rem}.login_img[data-v-01f91858]{width:3.125rem;height:3.125rem}",""])},QjDt:function(e,t,i){(e.exports=i("FZ+f")(!1)).push([e.i,".preview-img-bg[data-v-d204afc6]{position:fixed;left:0;top:0;height:100%;width:100%;background:rgba(0,0,0,.9);z-index:2002;overflow:hidden}.preview-img-mask[data-v-d204afc6]{position:fixed;top:50%;left:50%;width:100%;overflow:hidden;-webkit-transition:.3s;transition:.3s;border-radius:.125rem;background-color:#fff;-webkit-transform:translate3d(-50%,-50%,0);transform:translate3d(-50%,-50%,0);z-index:2003}",""])},S7RC:function(e,t,i){(e.exports=i("FZ+f")(!1)).push([e.i,".color-reply-user[data-v-18286121]{color:#477fb6;font-size:.875rem}.comment-img[data-v-18286121]{width:6.5625rem;height:6.5625rem;margin-right:.625rem}.comment-img img[data-v-18286121]{width:100%;height:100%;max-width:100%;max-height:100%}.user-img[data-v-18286121]{width:1.875rem;height:1.875rem}.shop-info-box[data-v-18286121]{background:#fff;-webkit-box-shadow:0 .125rem .28125rem .1875rem hsla(0,3%,88%,.5);box-shadow:0 .125rem .28125rem .1875rem hsla(0,3%,88%,.5);border-radius:.46875rem}.shop-img[data-v-18286121]{width:4.0625rem;height:4.0625rem;border-radius:.3125rem}.shop-img img[data-v-18286121]{width:100%;height:100%;max-width:100%;max-height:100%;border-radius:.3125rem}.grep-line[data-v-18286121]{background:#eee;height:.125rem;margin-top:1.875rem;margin-bottom:1.25rem}.comment-section[data-v-18286121]{border-bottom:.0625rem solid #eee}.replay-content[data-v-18286121]{padding-left:.625rem;border-left:.125rem solid #eee}.bottom-line-box[data-v-18286121]{padding-top:.9375rem;padding-bottom:3.625rem}.bottom-line[data-v-18286121]{height:.0625rem;background:#eee;-webkit-box-flex:2;-ms-flex:2;flex:2}.replay-container[data-v-18286121]{position:fixed;bottom:0;left:0;padding-left:.9375rem;padding-right:.9375rem;width:100%;height:2.6875rem;z-index:1000;border-top:.0625rem solid #eee;-webkit-box-shadow:0 -.03125rem 0 0 #eee;box-shadow:0 -.03125rem 0 0 #eee;background:#fff}.reply-input[data-v-18286121]{-webkit-box-flex:2;-ms-flex:2;flex:2;height:1.5625rem;background:#f5f5f5;border-radius:.79688rem;border:none;color:#333;font-size:.75rem;padding-left:.9375rem;padding-top:.15625rem}.color-replybtn[data-v-18286121]{color:#f56d23}.mb86[data-v-18286121]{margin-bottom:2.6875rem}",""])},TDOm:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e._l(e.max,function(t){return i("i",{staticClass:"i mr5 i-star",class:{color11:t<=e.value,colore:t>e.value},on:{click:function(i){return e.onChange(t)}}})}),i("label",{staticClass:"ml5",class:[e.value>0?"color11":"colore"]},[e._v(e._s(e.value.toFixed(1)))])],2)};n._withStripped=!0;var r={render:n,staticRenderFns:[]};t.a=r},Tg06:function(e,t,i){"use strict";var n=i("Xxa5"),r=i.n(n),s=i("exGp"),a=i.n(s),o=i("Dd8w"),c=i.n(o),l=i("NYxO"),m=i("Y6tJ"),u=i("DHvs"),p=i("Fd2+"),d=i("jit6"),f=i("hxf6");t.a={components:{Star:m.a,Toast:p.r,ImagePreview:d.a,Login:f.a},head:function(){return{title:"中原吃货地图"}},data:function(){return{replys:[],replyMessage:"",placeholder:"评价了才是真爱~",replyId:"",isPreview:!1,initial:0,previewImage:[],loginFlag:!1}},computed:c()({},Object(l.mapState)({user:function(e){return e.user.info}})),asyncData:function(){var e=a()(r.a.mark(function e(t){var i,n,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i={lat:t.query.lat,lng:t.query.lng},e.next=3,u.b.get("/v3/comment/"+t.params.id,i,t);case 3:if(n=e.sent,"OK"!==(s=n.data).msg||2e5!==s.code){e.next=7;break}return e.abrupt("return",{comment:s.comment,commentId:t.params.id,liked:s.comment.is_favorite});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),mounted:function(){this.user.id&&(this.loginFlag=!0)},directives:{intoTopView:{inserted:function(e){e.addEventListener("click",function(){setTimeout(function(){e.scrollIntoView(!0)},200)})},unbind:function(e){e.removeEventListener("click",function(){var t;setTimeout(function(){t=document.documentElement.clientHeight;var i=e.getBoundingClientRect();i.bottom>t&&e.scrollIntoView(!1)},200)})}}},methods:{sensData:function(e){Object(u.l)(e)},fetchReplys:function(){var e=a()(r.a.mark(function e(){var t,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.b.get("/v3/comment/"+this.commentId+"/replies",{offset:this.replys.length,limit:5});case 2:if(t=e.sent,"OK"!==(i=t.data).msg||2e5!==i.code){e.next=7;break}return this.replys=this.replys.concat(i.data),e.abrupt("return",{length:this.replys.length,isMore:(i.data||[]).length>0});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),toInputReply:function(e){this.replyId=e.id,this.placeholder="回复"+e.member.nickname,this.$refs.replyInput.focus()},resetReply:function(){this.replyId="",this.placeholder="评价了才是真爱~"},like:function(){var e=a()(r.a.mark(function e(){var t,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loginFlag||this.toLogin(),Object(u.l)("fm_commentDetailLike"),e.next=4,u.b.post("/v3/member/favorite",{type:"7",target_id:this.commentId});case 4:t=e.sent,2e5===(i=t.data).code?(this.liked?--this.comment.like_num:++this.comment.like_num,this.liked=!this.liked):Object(p.r)({message:i.msg,duration:2e3});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),replyTop:function(){this.loginFlag||this.toLogin()},submitReply:function(){var e=a()(r.a.mark(function e(){var t,i,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.replyMessage&&0!==this.replyMessage.length){e.next=2;break}return e.abrupt("return");case 2:return Object(u.l)("fm_commentDetailPublish"),t={shop_id:this.comment.shop.id,comment_id:this.replyId?this.replyId:this.commentId,content:this.replyMessage},e.next=6,u.b.post("/v3/comment",t);case 6:i=e.sent,"OK"===(n=i.data).msg&&2e5===n.code?(Object(p.r)({message:"感谢您的评价！",duration:2e3}),this.replyMessage="",this.resetReply(),this.$refs.replyInput.blur()):Object(p.r)({message:n.msg,duration:2e3});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),imagePreview:function(e,t){this.previewImage=[],this.previewImage=e,this.initial=t,this.isPreview=!0},closeImg:function(){this.previewImage=[],this.initial=0,this.isPreview=!1},toLogin:function(){Object(u.i)()?this.getWeixinUser():this.$refs.loginref.Login("app")},getWeixinUser:function(){var e=location.href,t=e.indexOf("?"),i=e.substr(t+1);this.userInfoQry(i)},userInfoQry:function(){var e=a()(r.a.mark(function e(t){var i,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.b.get("/weixin/tools/wxLogin",{urlParam:t});case 2:i=e.sent,n=i.data,200===i.status&&"SUCCESS"===n.code&&this.$store.dispatch("user/getUser");case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}}},Y6tJ:function(e,t,i){"use strict";var n=i("yMFp"),r=i("TDOm"),s=!1;var a=function(e){s||i("3T1h")},o=i("VU/8")(n.a,r.a,!1,a,"data-v-5a417cc0",null);o.options.__file="components/Shop/Star.vue",t.a=o.exports},YzF7:function(e,t,i){"use strict";t.a={props:["images","isPreview","initial"],data:function(){return{shopSwiper:{initialSlide:this.initial}}},methods:{close:function(){this.$emit("imagePreview")}}}},fYTP:function(e,t,i){"use strict";var n=function(){var e=this.$createElement;return(this._self._c||e)("div")};n._withStripped=!0;var r={render:n,staticRenderFns:[]};t.a=r},hxf6:function(e,t,i){"use strict";var n=i("Ds5F"),r=i("fYTP"),s=!1;var a=function(e){s||i("n0MW")},o=i("VU/8")(n.a,r.a,!1,a,"data-v-01f91858",null);o.options.__file="components/LoginZybankApp.vue",t.a=o.exports},jYZW:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"w100 bg-white"},[i("div",{staticClass:"bg-white"},[i("div",{staticClass:"w100 plr30 pt25 flex-wrp flex-align-center"},[i("img",{staticClass:"user-img mr10",attrs:{src:e.comment.member.head_img}}),i("label",{staticClass:"size28 color48"},[e._v(e._s(e.comment.member.nickname))])]),i("div",{staticClass:"w100 plr30 mt25 size30 color48",on:{click:function(t){return e.toInputReply(e.comment)}}},[e._v(e._s(e.comment.content))]),i("div",{staticClass:"w100 plr30 mt25 flex-wrp flex-align-center"},e._l(e.comment.pics,function(t,n){return i("div",{key:"pic_"+n,staticClass:"comment-img",on:{click:function(t){return e.imagePreview(e.comment.pics,n)}}},[i("img",{attrs:{src:t}})])}),0),i("div",{staticClass:"w100 plr30 mt30  flex-wrp flex-align-center flex-between"},[i("label",{staticClass:"size24 color44"},[e._v(e._s(e.comment.created_at))]),i("label",{staticClass:"flex-wrp flex-align-center size28 text-right",class:[e.liked?"color-replybtn":"color44"],on:{click:function(t){return e.like()}}},[e.liked?i("i",{staticClass:"z z-praise ml20 mr10 size28"}):i("i",{staticClass:"z z-praise-o ml20 mr10 size28"}),e._v(e._s(e.comment.like_num)+"\n            ")])]),i("nuxt-link",{attrs:{to:{path:"/shop_"+e.comment.shop.id}},nativeOn:{click:function(t){return e.sensData("fm_commentDetailShop")}}},[i("div",{staticClass:"mg30 shop-info-box flex-wrp flex-align-center pd20"},[i("div",{staticClass:"shop-img"},[i("img",{attrs:{src:e.comment.shop.logo}})]),i("div",{staticClass:"flex-cell ml20 flex-item"},[i("div",{staticClass:"size32 color48 compulsory-row"},[e._v(e._s(e.comment.shop.name))]),i("div",{staticClass:"flex-wrp flex-align-center"},[i("star",{staticClass:"size24 mt5",attrs:{max:5,value:parseInt(e.comment.shop.score)}}),i("label",{staticClass:"size24 color11 ml10"},[e._v(e._s(e.comment.shop.score.score))])],1),i("div",{staticClass:"flex-wrp flex-align-center mt5"},[i("img"),i("label",{staticClass:"size24 color5 mr10"},[e._v(e._s(e.comment.shop.tag))]),i("i",{staticClass:"i i-location-o size26 color44 mr5"}),i("label",{staticClass:"size24 color5"},[e._v(e._s(e.comment.shop.distance?e.comment.shop.distance.number:"0")+e._s(e.comment.shop.distance?e.comment.shop.distance.unit:"km"))])])])])]),i("image-preview",{attrs:{isPreview:e.isPreview,initial:e.initial,images:e.previewImage},on:{imagePreview:e.closeImg}}),i("div",{staticClass:"grep-line mlr30"}),i("div",{staticClass:"plr30 flex-wrp flex-align-center bg-white size28 pb20"},[i("label",{staticClass:"size32 color48 mr10"},[e._v("全部评论")]),i("label",{staticClass:"size24 color44"},[e._v("("+e._s(e.comment.reply_num)+")")])]),e._l(e.replys,function(t,n){return i("div",{key:n,staticClass:"comment-section mt30 pb30 mlr30 bg-white",on:{click:function(i){return e.toInputReply(t)}}},[i("div",{staticClass:"w100 mt25 flex-wrp flex-align-center"},[i("img",{staticClass:"user-img mr10",attrs:{src:t.member.head_img}}),i("label",{staticClass:"size28 color48"},[e._v(e._s(t.member.nickname))])]),i("div",{staticClass:"w100 mt25 size30 color48"},[e._v(e._s(t.content))]),i("div",{staticClass:"w100 mt25 size24 color44"},[e._v(e._s(t.created_at))]),t.p_id!==e.commentId?i("div",{staticClass:"replay-content mt25 mb30 size28 flex-wrp flex-cell"},[i("div",{staticClass:"color-reply-user"},[e._v(e._s(t.to_member.nickname))]),i("div",{staticClass:"color48 mt10"},[e._v(e._s(t.to_member.content))])]):e._e()])})],2),i("load-more",{ref:"loadMore",staticClass:"mb86",attrs:{handler:e.fetchReplys,noMore:"new",noResult:"new"}}),i("div",{directives:[{name:"intoTopView",rawName:"v-intoTopView"}],staticClass:"replay-container flex-wrp flex-align-center"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.replyMessage,expression:"replyMessage"}],ref:"replyInput",staticClass:"reply-input",attrs:{maxlength:"100",name:"replyInput",placeholder:e.placeholder},domProps:{value:e.replyMessage},on:{focus:function(t){return e.replyTop()},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitReply()},input:function(t){t.target.composing||(e.replyMessage=t.target.value)}}}),i("label",{staticClass:"size28 ml30",class:[e.replyMessage.length>0?"color-replybtn":"color44"],on:{click:function(t){return e.submitReply()}}},[e._v("发布")])]),i("login",{ref:"loginref"})],1)};n._withStripped=!0;var r={render:n,staticRenderFns:[]};t.a=r},jit6:function(e,t,i){"use strict";var n=i("YzF7"),r=i("DKNh"),s=!1;var a=function(e){s||i("L8Vq")},o=i("VU/8")(n.a,r.a,!1,a,"data-v-d204afc6",null);o.options.__file="components/comments/ImagePreview.vue",t.a=o.exports},n0MW:function(e,t,i){var n=i("Ldk8");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i("rjj0")("5b0a07a5",n,!1,{sourceMap:!1})},yMFp:function(e,t,i){"use strict";t.a={props:{value:{type:Number,default:0},max:{type:Number,default:5}},methods:{onChange:function(e){this.$emit("onChange",e)}}}}});