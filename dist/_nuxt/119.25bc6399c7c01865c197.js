webpackJsonp([119],{"27aa":function(t,e,n){var a=n("ME64");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("rjj0")("6369c2d9",a,!1,{sourceMap:!1})},ME64:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,'.warp[data-v-18804380]{padding-top:20.3125rem;background:url("https://public.duduapp.net/dolife/static/images/user_login.png") no-repeat center 4.6875rem;background-size:90% auto}',""])},SzBI:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"warp"},[n("div",{staticClass:"weui-btn-area"},[n("a",{staticClass:"weui-btn weui-btn_primary",attrs:{href:t.backUrl}},[t._v(t._s(t.btnText))]),n("a",{staticClass:"weui-btn weui-btn_primary",on:{click:function(e){return t.Login("app")}}},[t._v("本地登陆测试")]),n("a",{staticClass:"weui-btn weui-btn_primary",on:{click:function(e){return t.Login("wechat")}}},[t._v("微信登陆测试")])])])};a._withStripped=!0;var r={render:a,staticRenderFns:[]};e.a=r},bIR0:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("j9W0"),r=n("SzBI"),s=!1;var i=function(t){s||n("27aa")},o=n("VU/8")(a.a,r.a,!1,i,"data-v-18804380",null);o.options.__file="pages/login.vue",e.default=o.exports},j9W0:function(t,e,n){"use strict";var a=n("mvHQ"),r=n.n(a),s=n("Dd8w"),i=n.n(s),o=n("Xxa5"),c=n.n(o),u=n("exGp"),p=n.n(u),l=n("DHvs"),d=n("NYxO");e.a={asyncData:function(){var t=p()(c.a.mark(function t(e){var n;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={btnText:"登录",backUrl:e.query.url,loginParam:{},loginResponseData:{}},Object(l.i)(e.userAgent)?n.btnText="微信登录":Object(l.c)(e.userAgent)&&(n.btnText="支付宝登录"),t.abrupt("return",n);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),computed:i()({},Object(d.mapState)({user:function(t){return t.user}})),mounted:function(){alert(r()(this.$store.state.user));var t=this;window.loginForResponse=function(e,n,a){t.loginResponseData={type:"app",url:e,data:n,sign:a},t.getUserInfoForZyBank()},window.wechatLoginForResponse=function(e,n){t.loginResponseData={type:"wechat",data:e,sign:n},t.getUserInfoForZyBank()},window.onResponseError=function(){alert("获取授权失败,请重试!"),window.history.back()}},methods:{Login:function(){var t=p()(c.a.mark(function t(e){var n,a,s;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=location.href,t.next=3,l.b.get("/zybank/prelogin",{url:n});case 3:a=t.sent,s=a.data,200===a.status&&"SUCCESS"===s.code&&(this.loginParam=s.data),alert(r()(this.loginParam)),t.t0=e,t.next="app"===t.t0?11:"wechat"===t.t0?13:15;break;case 11:return Object(l.d)()?(alert("android app"),window.demo.clickOnAndroid(this.loginParam.loginUrl,this.loginParam.crypted,this.loginParam.sign)):Object(l.e)()&&(alert("ios app"),window.location.href="objc://loginBank:/,"+this.loginParam.loginUrl+","+this.loginParam.crypted+","+this.loginParam.sign),t.abrupt("break",15);case 13:return Object(l.d)()?window.demo.wechatLoginOnAndroid():Object(l.e)()&&(window.location.href="objc://wechatLogin:/"),t.abrupt("break",15);case 15:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),getUserInfoForZyBank:function(){var t=p()(c.a.mark(function t(){var e,n;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return alert("LoginFor"+this.loginResponseData.type),t.next=3,l.b.post("/zybank/setlogin",this.loginResponseData);case 3:if(e=t.sent,n=e.data,200!==e.status||"SUCCESS"!==n.code){t.next=14;break}return alert("登陆成功"),alert(r()(this.$store.state.user.info)),t.next=11,this.$store.dispatch("user/getUser");case 11:alert(r()(this.$store.state.user.info)),t.next=15;break;case 14:alert("登陆失败");case 15:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),showInfo:function(){var t=p()(c.a.mark(function t(e){var n,a;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return alert("showinfo"),t.next=3,l.b.get("/user",null,e);case 3:n=t.sent,a=n.data,200===n.status&&"SUCCESS"===a.code?alert(r()(a.user)):alert("未获取到登陆信息");case 7:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}}}});