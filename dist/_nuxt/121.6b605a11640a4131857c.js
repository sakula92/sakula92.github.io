webpackJsonp([121],{"4Ouo":function(t,i,e){(t.exports=e("FZ+f")(!1)).push([t.i,".title[data-v-b7a62f58]{position:absolute;left:0;bottom:0;background:-webkit-gradient(linear,left top,left bottom,from(transparent),to(rgba(0,0,0,.7)));background:linear-gradient(transparent,rgba(0,0,0,.7))}.fontweight[data-v-b7a62f58]{font-weight:700}",""])},H0oV:function(t,i,e){"use strict";var s=e("Dd8w"),n=e.n(s),a=e("Xxa5"),r=e.n(a),o=e("exGp"),l=e.n(o),c=e("DHvs"),f=e("NYxO");i.a={asyncData:function(){var t=l()(r.a.mark(function t(i){var e,s;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.b.get("/gift/"+i.params.id,null,i);case 2:if(e=t.sent,"SUCCESS"!==(s=e.data).code){t.next=8;break}return t.abrupt("return",{gift:s.gift});case 8:return t.abrupt("return",i.error({statusCode:404,message:"商品下架或找不到"}));case 9:case"end":return t.stop()}},t,this)}));return function(i){return t.apply(this,arguments)}}(),head:function(){return{title:this.gift.title}},computed:n()({},Object(f.mapState)({config:function(t){return t.config},user:function(t){return t.user.info}})),mounted:function(){c.o.setShare({title:this.gift.title,imgUrl:this.gift.thumb,desc:"关注订阅【"+this.config.siteConfig.sitename+"】尊享全城特惠"})},watch:{},methods:n()({},Object(f.mapActions)({userIncreaseCredit:"user/userIncreaseCredit"}),{onBuy:function(){var t=l()(r.a.mark(function t(){var i,e;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.b.post("/gift/"+this.gift.id+"/buy");case 2:i=t.sent,"SUCCESS"===(e=i.data).code?(this.userIncreaseCredit({credit:e.credit}),this.onShow()):e.msg&&weui.alert(e.msg,{title:"兑换失败"});case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),onBuyConfirm:function(){var t=l()(r.a.mark(function t(){var i,e,s;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=(i=this).user.is_vip&&i.gift.vip_info?i.gift.vip_info.fee:i.gift.fee,s=weui.dialog({content:'\n<div class="color4 lh150 ptb30">\n    <div class="pt30">您确定要使用'+e+"积分</div>\n    <div>兑换"+i.gift.title+"么？</div>\n</div>",buttons:[{label:"取消",type:"default",onClick:!1},{label:"确定",type:"primary",onClick:function(){s.hide(function(){i.onBuy()})}}]});case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),onShow:function(){var t=this;weui.dialog({title:"兑换成功",content:'\n<div class="lh150">\n    <div class="color4">可在"我的兑换"中查看</div>\n</div>',buttons:[{label:"取消",type:"default",onClick:!1},{label:"查看",type:"primary",onClick:function(){t.$router.push({path:"/user_gifts"})}}]})}})}},HAnE:function(t,i,e){var s=e("4Ouo");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);e("rjj0")("41913af8",s,!1,{sourceMap:!1})},KhB8:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e("H0oV"),n=e("L8X1"),a=!1;var r=function(t){a||e("HAnE")},o=e("VU/8")(s.a,n.a,!1,r,"data-v-b7a62f58",null);o.options.__file="pages/gift/_id.vue",i.default=o.exports},L8X1:function(t,i,e){"use strict";var s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("base-header",[e("div",{staticClass:"flex-wrp flex-align-center",attrs:{slot:"title"},slot:"title"},[t._v("\n            兑换详情\n        ")])]),e("div",{staticClass:"relative"},[e("img",{staticClass:"block bg-cover100 w100",attrs:{src:t.gift.thumb}}),e("div",{staticClass:"w100 color1 size28 title"},[e("div",{staticClass:"pd30"},[t._v(t._s(t.gift.title))])])]),e("div",{staticClass:"flex-wrp flex-align-center bg-white pd30 flex-end"},[t._m(0),t.user.is_vip&&t.gift.vip_info?[e("div",{staticClass:"color7 size32 pl10 lh100"},[t._v(t._s(t.gift.vip_info.fee)+"积分")]),e("div",{staticClass:"color4 size18 pl10 lh100 del"},[t._v(t._s(t.gift.fee)+"积分")])]:[e("div",{staticClass:"color7 size32 pl10 lh100"},[t._v(t._s(t.gift.fee)+"积分")])],e("div",{staticClass:"flex-item"}),t.gift.sold>0?e("div",{staticClass:"color14 size28 lh100"},[t._v(t._s(t.gift.sold)+"人兑换")]):t._e()],2),e("div",{staticClass:"bg-white pd30 mt20"},[e("div",{staticClass:"size32 color16 pb20 fontweight"},[t._v("兑换须知")]),e("div",{staticClass:"color5 lh150 size24"},[t._v("兑换商家："+t._s(t.gift.shop.name))]),e("div",{staticClass:"color5 lh150 size24"},[t._v("有效期至："+t._s(t.gift.expiry.substring(0,16)))]),t.gift.limit_num>0?e("div",{staticClass:"color5 lh150 size24"},[t._v("限兑次数："+t._s(t.gift.limit_num))]):t._e(),t.gift.limit_time&&t.gift.limit_time>0?e("div",{staticClass:"color3 lh150 size25"},[t._v("购买期限："+t._s(t.gift.limit_time)+"\n        ")]):t._e(),e("div",{staticClass:"size32 color16 pt30 fontweight"},[t._v("兑换说明")]),e("no-ssr",[e("div",{staticClass:"color5 my-img size24 line12 size24",domProps:{innerHTML:t._s(t.gift.content)}})])],1),e("div",{style:{height:"50px"}}),e("div",{staticClass:"fixed-bottom bg-white border-t"},[e("div",{staticClass:"plr30"},[e("div",{staticClass:"bg-orange border-radius10 color10 size32 pd25 text-center",on:{click:t.onBuyConfirm}},[t._v("兑换\n            ")])])])],1)};s._withStripped=!0;var n={render:s,staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"lh100"},[i("i",{staticClass:"i i-jf color14 size26 lh100"})])}]};i.a=n}});