webpackJsonp([116],{"/ZPp":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("DPKd"),i=a("XdkP"),n=!1;var s=function(t){n||a("aZHB")},o=a("VU/8")(r.a,i.a,!1,s,"data-v-1a07929f",null);o.options.__file="pages/paynew/paymore.vue",e.default=o.exports},DPKd:function(t,e,a){"use strict";var r=a("Xxa5"),i=a.n(r),n=a("exGp"),s=a.n(n),o=a("DHvs"),l=a("Fd2+");e.a={head:function(){return{title:"中原吃货地图"}},asyncData:function(){var t=s()(i.a.mark(function t(e){var a,r,n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.b.get("/user/order/"+e.query.order_id,{},e);case 2:if(a=t.sent,r=a.data,200!==(n=a.status)||"SUCCESS"!==r.code){t.next=9;break}return t.abrupt("return",{order:r.order,pay_version:r.pay_version});case 9:return t.abrupt("return",e.error({statusCode:n,message:"订单不存在"}));case 10:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),data:function(){return{amount:"",flag:"disabled",payPlatParams:{}}},computed:{payFee:function(){return this.amount&&"disabled"!==this.flag?this.subtr(this.amount,this.order.total_fee):"0.00"}},methods:{toPay:function(){var t=s()(i.a.mark(function t(){var e,a,r,n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={order_id:this.order.id,total_fee:this.amount,pay_fee:this.payFee},t.next=3,o.b.post("/v3/member/order/buying",e);case 3:a=t.sent,2e5===(r=a.data).code?(n=r.data.orderId,Object(o.i)()?location.href="/payment?id="+n:"v2"!==this.pay_version?this.getPayPlatform(n):this.$router.push({path:"/order_pay",query:{order_id:n,type:"paymore"}})):l.c.alert({title:"温馨提示",message:r.msg,messageAlign:"center"});case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getPayPlatform:function(){var t=s()(i.a.mark(function t(e){var a,r,n=this;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.b.post("/user/order/pay",{order_id:e});case 2:a=t.sent,"SUCCESS"===(r=a.data).code?(this.$set(this.payPlatParams,"url",r.url),this.$set(this.payPlatParams,"Plain",r.data.Plain),this.$set(this.payPlatParams,"Signature",r.data.Signature),this.$nextTick(function(){n.$refs.zybankPay.submit()})):l.c.alert({title:"温馨提示",message:r.msg,messageAlign:"center"});case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),checkAmount:function(t){for(var e=t.value,a=[["^\\.$",""],["^0(\\d+)$","$1"],["[^\\d\\.]+$",""],["\\.(\\d?)\\.+",".$1"],["^(\\d+\\.\\d{2}).+","$1"]],r=0;r<a.length;r++){var i=new RegExp(a[r][0]);e=e.replace(i,a[r][1])}if(String(e).indexOf(".")<0)e=String(e).length>8?String(e).substring(0,8):e;else{var n=String(e).split(".");e=(n[0].length>8?n[0].substring(0,8):n[0])+"."+n[1]}t.value=e,this.amount=e,isNaN(this.amount)?this.flag="disabled":this.flag=!(this.amount>Number(this.order.total_fee))&&"disabled"},subtr:function(t,e){var a,r,i;try{a=t.toString().split(".")[1].length}catch(t){a=0}try{r=e.toString().split(".")[1].length}catch(t){r=0}return((t*(i=Math.pow(10,Math.max(a,r)))-e*i)/i).toFixed(a>=r?a:r)}}}},XdkP:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bg-grey fullHeight"},[a("div",{staticClass:"pay-more-box"},[a("div",{staticClass:"pay-more-name"},[t._v(t._s(t.order.detail.shop.title))]),a("div",{staticClass:"pay-more-input-box flex-wrp flex-align-center"},[a("label",{staticClass:"color37 size28 mr20"},[t._v("消费总额(元)：")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"amount"}],ref:"amountRef",staticClass:"pay-more-input flex-item",attrs:{type:"number",placeholder:"请与商家确认金额"},domProps:{value:t.amount},on:{input:[function(e){e.target.composing||(t.amount=e.target.value)},function(e){return t.checkAmount(e.target)}]}})])]),a("form",{ref:"zybankPay",staticStyle:{display:"none"},attrs:{action:t.payPlatParams.url,method:"post",id:"zybankPay"}},[a("input",{attrs:{type:"hidden",name:"Plain"},domProps:{value:t.payPlatParams.Plain}}),a("input",{attrs:{type:"hidden",name:"Signature"},domProps:{value:t.payPlatParams.Signature}})]),a("div",{staticClass:"flex-wrp flex-align-center bg-white plr30 h103 mt20"},["5"===t.order.module_id?a("div",{staticClass:"coupon-btn",class:["disabled"===t.flag?"coupon-btn-dis":"coupon-btn-active"]},[t._v("吃货券")]):a("div",{staticClass:"coupon-btn",class:["disabled"===t.flag?"coupon-btn-dis":"coupon-btn-active"]},[t._v("已抢购")]),a("label",{staticClass:"ml20 compulsory-row-one size28 flex-item text-right color44"},[t._v(t._s(t.order.title))])]),a("div",{staticClass:"flex-wrp flex-align-center bg-white size28 plr30 h103 mt20 border-b"},[a("div",{staticClass:"color37 mr20"},[t._v("折扣金额(元)：")]),a("div",{staticClass:"color67 flex-item text-right"},[t._v("-￥"+t._s(t.order.total_fee))])]),a("div",{staticClass:"flex-wrp flex-align-center bg-white size28 plr30 h103"},[a("div",{staticClass:"color37 mr20"},[t._v("实付金额(元)：")]),a("div",{staticClass:"color67 flex-item text-right"},[t._v(t._s(t.payFee))])]),a("div",{staticClass:"w100 plr30 mt130"},[a("button",{staticClass:"pay-more-btn",attrs:{type:"button",disabled:t.flag},on:{click:function(e){return t.toPay()}}},[t._v("确认支付")])]),t._m(0)])};r._withStripped=!0;var i={render:r,staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pay-more-tips"},[e("p",{staticClass:"size36 color37 mb10"},[this._v("买单说明：")]),e("p",{staticClass:"size28 color37 lh42 mt10"},[this._v("1.首次使用，可与商家确认买单规则；"),e("br"),this._v("2.仅限到店消费后使用，请勿提前支付；"),e("br"),this._v("3.请在确认支付前与商家确认消费金额；"),e("br"),this._v("4.买单功能不参加优惠券活动。")])])}]};e.a=i},aZHB:function(t,e,a){var r=a("gWQa");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a("rjj0")("f7ce20f8",r,!1,{sourceMap:!1})},gWQa:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,".pay-more-box[data-v-1a07929f]{background-color:#fff;padding:.9375rem}.pay-more-name[data-v-1a07929f]{width:100%;font-size:1rem;height:1.40625rem;line-height:1.40625rem;color:#333;letter-spacing:0;text-align:center;margin:.9375rem 0}.pay-more-input-box[data-v-1a07929f]{position:relative;top:.15625rem;width:100%;height:3rem;border:.0625rem solid #ccc;border-radius:.3125rem;padding:0 .9375rem}.coupon-btn[data-v-1a07929f]{height:1.375rem;line-height:1.375rem;background-image:-webkit-gradient(linear,right top,left top,from(#fba649),to(#f56d23));background-image:linear-gradient(-90deg,#fba649,#f56d23);color:#fff;text-align:center;padding:0 .3125rem;border-radius:.65rem;font-size:.875rem}.coupon-btn-active[data-v-1a07929f]{opacity:1}.coupon-btn-dis[data-v-1a07929f]{opacity:.5}.pay-more-input[data-v-1a07929f]{background-color:#fff;font-size:.875rem;text-align:right;border:none;color:#db1013}.h103[data-v-1a07929f]{height:3.21875rem}.mt130[data-v-1a07929f]{margin-top:4.0625rem}.pay-more-btn[data-v-1a07929f]{height:2.6875rem;width:100%;background:#f56d23;border-radius:.3125rem;font-size:1.125rem;color:#fff;letter-spacing:.1875rem;text-align:center;border:none}.pay-more-btn[data-v-1a07929f]:disabled{background:#ccc}.pay-more-tips[data-v-1a07929f]{margin-top:22vh;width:100%;padding:0 .9375rem}.lh42[data-v-1a07929f]{line-height:1.3125rem}",""])}});